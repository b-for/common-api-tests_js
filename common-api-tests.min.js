const COMMON={ERROR:{OFFSET:3},TYPE_ERROR:{MESSAGE:"Wrong argument type for function"},RANGE_ERROR:{MESSAGE:"Argument out of range for function"}};function testCommon(e,t,r,n){logResponseBody(),e&&checkStatusCode(e),t&&checkContentType(t),r&&checkJSONSchema(r),n&&checkLocation(n)}function testCommonAndTime(e,t,r,n,o){testCommon(e,r,n,o),t&&checkTime(t)}function logResponseBody(){const e=pm.response.text();e&&pm.test(`Response Body: ${e}`,()=>{})}function getType(e){return Object.prototype.toString.call(e).replace(/^\[object |\]$/g,"")}function getFunctionNameFromInside(e){if("Error"===getType(e)){let t=e.stack.split(/\r\n|\r|\n/g)[1].trim();return t=t.substr(COMMON.ERROR.OFFSET,t.indexOf("(")-1-COMMON.ERROR.OFFSET)}throw new TypeError(`${COMMON.TYPE_ERROR.MESSAGE} getFunctionNameFromInside`)}function getIndexObjectInArray(e,t,r){if(Array.isArray(e)&&e.every(e=>"Object"===getType(e))&&"String"===getType(t))return e.findIndex(e=>e[t]===r);throw new TypeError(`${COMMON.TYPE_ERROR.MESSAGE} ${getFunctionNameFromInside(new Error)}`)}function convertTime(e){if("Number"===getType(e))return e>=1e3?`${e/1e3}s`:`${e}ms`;throw new TypeError(`${COMMON.TYPE_ERROR.MESSAGE} ${getFunctionNameFromInside(new Error)}`)}function delayTime(e){if("Number"!==getType(e))throw new TypeError(`${COMMON.TYPE_ERROR.MESSAGE} ${getFunctionNameFromInside(new Error)}`);console.log(`Delaying for ${convertTime(e)}...`),setTimeout(()=>console.log("Delay finished"),e)}function generateNumber(e,t){if("Number"===getType(e)&&"Number"===getType(t)){if(e<=t)return Math.floor(Math.random()*(t-e+1)+e);throw new RangeError(`${COMMON.RANGE_ERROR.MESSAGE} ${getFunctionNameFromInside(new Error)}`)}throw new TypeError(`${COMMON.TYPE_ERROR.MESSAGE} ${getFunctionNameFromInside(new Error)}`)}function generateString(e){if("Number"===getType(e)){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";let r="";for(let n=0;n<e;n++)r+=t.charAt(Math.floor(Math.random()*t.length));return r}throw new TypeError(`${COMMON.TYPE_ERROR.MESSAGE} ${getFunctionNameFromInside(new Error)}`)}function checkTime(e){if("Number"!==getType(e))throw new TypeError(`${COMMON.TYPE_ERROR.MESSAGE} ${getFunctionNameFromInside(new Error)}`);if(!(e>0))throw new RangeError(`${COMMON.RANGE_ERROR.MESSAGE} ${getFunctionNameFromInside(new Error)}`);pm.test(`Response Time < ${convertTime(e)}`,()=>{pm.expect(pm.response.responseTime).to.be.below(e)})}function checkStatusCode(e){if("Number"!==getType(e))throw new TypeError(`${COMMON.TYPE_ERROR.MESSAGE} ${getFunctionNameFromInside(new Error)}`);switch(pm.response.code==e||401!==pm.response.code&&403!==pm.response.code&&500!==pm.response.code&&502!==pm.response.code&&503!==pm.response.code&&504!==pm.response.code||postman.setNextRequest(null),!0){case 100<=e&&e<=199:pm.test("Status Code (Information)",()=>{pm.response.to.have.status(e)});break;case 200<=e&&e<=299:pm.test("Status Code (Success)",()=>{pm.response.to.have.status(e)});break;case 300<=e&&e<=399:pm.test("Status Code (Redirection)",()=>{pm.response.to.have.status(e)});break;case 400<=e&&e<=499:pm.test("Status Code (Client Error)",()=>{pm.response.to.have.status(e)});break;case 500<=e&&e<=599:pm.test("Status Code (Server Error)",()=>{pm.response.to.have.status(e)});break;default:throw new RangeError(`${COMMON.RANGE_ERROR.MESSAGE} ${getFunctionNameFromInside(new Error)}`)}}function checkContentType(e){if("String"!==getType(e))throw new TypeError(`${COMMON.TYPE_ERROR.MESSAGE} ${getFunctionNameFromInside(new Error)}`);pm.test("Content Type",()=>{pm.response.to.have.header("Content-Type"),pm.expect(pm.response.headers.get("Content-Type")).to.include(e)})}function checkJSONSchema(e){if("Object"!==getType(e))throw new TypeError(`${COMMON.TYPE_ERROR.MESSAGE} ${getFunctionNameFromInside(new Error)}`);{const t=tv4.validate(pm.response.json(),e),r=t?"JSON Schema":`JSON Schema (${tv4.error.message} for data path ${tv4.error.dataPath?tv4.error.dataPath:"/"})`;pm.test(r,()=>pm.expect(t).to.be.true)}}function checkLocation(e){if("String"!==getType(e))throw new TypeError(`${COMMON.TYPE_ERROR.MESSAGE} ${getFunctionNameFromInside(new Error)}`);pm.test("Location",()=>{pm.response.to.be.header("Location",e)})}function getRegexGUID(){return"^(?!00000000-0000-0000-0000-000000000000)([0-9a-zA-Z]{8}-[0-9a-zA-Z]{4}-[0-9a-zA-Z]{4}-[0-9a-zA-Z]{4}-[0-9a-zA-Z]{12})$"}function getRegexISODateTime(){return"^(?!0001-01-01T00:00:00Z)([0-9]{4}-[0-9]{2}-[0-9]{2}T[0-9]{2}:[0-9]{2}:[0-9]{2}.?[0-9]*Z)$"}function getRegexURL(){return"^https?://[0-9a-zA-Z-]+\\.[0-9a-zA-Z-]+|https?://localhost"}function getSchemaHAL(e={}){if("Object"===getType(e))return{type:"object",required:["_links","_embedded","_page"],properties:{_links:{type:"object",required:["self","first","last"],properties:{self:{type:"object",required:["href"],properties:{href:{type:"string",pattern:getRegexURL()}}},next:{type:["object","null"],required:["href"],properties:{href:{type:"string",pattern:getRegexURL()}}},previous:{type:["object","null"],required:["href"],properties:{href:{type:"string",pattern:getRegexURL()}}},first:{type:"object",required:["href"],properties:{href:{type:"string",pattern:getRegexURL()}}},last:{type:"object",required:["href"],properties:{href:{type:"string",pattern:getRegexURL()}}}}},_embedded:{type:"object",required:["resourceList"],properties:{resourceList:{type:"array",items:e}}},_page:{type:"object",required:["size","number"],properties:{size:{type:"number",minimum:0,multipleOf:1},totalElements:{type:"number",minimum:0,multipleOf:1},totalPages:{type:"number",minimum:0,multipleOf:1},number:{type:"number",minimum:1,multipleOf:1}}}}};throw new TypeError(`${COMMON.TYPE_ERROR.MESSAGE} ${getFunctionNameFromInside(new Error)}`)}
